FROM spark-base:2.4.4

ARG SPARK_MASTER_HOST_URL
ARG SPARK_MASTER_HOST

ENV SPARK_NO_DAEMONIZE=true
ENV SPARK_MASTER=${SPARK_MASTER_HOST_URL}
ENV SPARK_WORKER_CORES=2
ENV SPARK_WORKER_MEMORY=1024m
ENV SPARK_WORKER_WEBUI_PORT=8081
ENV SPARK_MASTER_HOST=${SPARK_MASTER_HOST}
ENV SPARK_MASTER_PORT=7077
ENV SPARK_HOME=/opt/spark-2.4.4-bin-hadoop2.7
ENV SPARK_SCALA_VERSION=2.12

RUN mkdir -p /mnt/spark/volume

EXPOSE 8081

ENTRYPOINT ["/bin/sh", "-c"]
CMD ["/opt/spark-2.4.4-bin-hadoop2.7/sbin/start-slave.sh spark://172.17.0.4:7077"]